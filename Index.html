<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nout Karro Fler ğŸŒ±</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", serif;
    background: #0a0a0a;
    color: #e6e6e6;
}

/* ---------- LOGIN ---------- */
#login {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.95);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

#loginBox {
    background: linear-gradient(145deg,#1a1a1a,#2a2a2a);
    padding: 40px;
    border-radius: 24px;
    width: min(90%,380px);
    text-align: center;
    box-shadow: 0 30px 60px rgba(0,0,0,.8);
    border: 1px solid rgba(76,175,80,.4);
}

#loginBox h1 {
    margin-top: 0;
    color: #4CAF50;
}

#loginBox input {
    width: 100%;
    padding: 16px;
    border-radius: 14px;
    border: none;
    margin-top: 20px;
    font-size: 16px;
}

#loginBox button {
    width: 100%;
    margin-top: 20px;
    padding: 16px;
    border-radius: 30px;
    border: none;
    font-size: 18px;
    background: linear-gradient(135deg,#4CAF50,#43a047);
    color: white;
    cursor: pointer;
}

/* ---------- MAIN ---------- */
#main { display: none; max-width: 1400px; margin: auto; }

/* Blackboard */
#blackboard {
    background: linear-gradient(145deg,#1a1a1a,#2a2a2a);
    padding: 30px;
    border-radius: 24px;
    margin-bottom: 30px;
    text-align: center;
    border: 1px solid rgba(76,175,80,.3);
}

#blackboard h2 {
    margin: 0 0 10px;
    color: #4CAF50;
}

#quote { font-style: italic; opacity: .85; }

/* Add button */
#addBtn {
    display: block;
    margin: 30px auto;
    padding: 18px 40px;
    border-radius: 40px;
    border: none;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    background: linear-gradient(135deg,#4CAF50,#43a047);
    color: white;
}

/* ---------- FORM ---------- */
#formOverlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.9);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 999;
}

#formOverlay form {
    background: linear-gradient(145deg,#1a1a1a,#2a2a2a);
    padding: 40px;
    border-radius: 24px;
    width: min(90%,500px);
    border: 1px solid rgba(76,175,80,.3);
}

#formOverlay h3 {
    margin-top: 0;
    text-align: center;
    color: #4CAF50;
}

#formOverlay input,
#formOverlay select,
#formOverlay textarea {
    width: 100%;
    margin-top: 14px;
    padding: 14px;
    border-radius: 14px;
    border: none;
    background: rgba(255,255,255,.05);
    color: white;
}

#formOverlay button {
    width: 100%;
    margin-top: 24px;
    padding: 16px;
    border-radius: 30px;
    border: none;
    font-size: 18px;
    background: linear-gradient(135deg,#4CAF50,#43a047);
    color: white;
    cursor: pointer;
}

/* ---------- GARDEN ---------- */
h2 {
    text-align: center;
    color: #4CAF50;
}

#garden {
    width: 100%;
    height: 600px;
    background: radial-gradient(ellipse at center,#1b1b1b 0%,#0a0a0a 70%);
    border-radius: 24px;
    border: 2px solid rgba(76,175,80,.5);
}

/* Plants */
.plant {
    cursor: pointer;
    transition: filter .3s ease, opacity .3s ease;
    filter: drop-shadow(0 4px 12px rgba(76,175,80,.3));
}

.plant:hover {
    filter: drop-shadow(0 8px 24px rgba(76,175,80,.7)) brightness(1.2);
    opacity: .95;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <div id="loginBox">
    <h1>ğŸŒ± Nout Karro Fler</h1>
    <p>Entre dans le jardin attentionnel</p>
    <input type="password" id="pwd" placeholder="Mot de passe">
    <button onclick="checkPassword()">Entrer</button>
  </div>
</div>

<!-- MAIN -->
<div id="main">

  <div id="blackboard">
    <h2>ğŸ“œ Citation du jardin</h2>
    <p id="quote"></p>
  </div>

  <button id="addBtn" onclick="openForm()">â• Nouvelle contribution</button>

  <div id="formOverlay">
    <form id="contribForm">
      <h3>ğŸŒ¿ Planter une expÃ©rience</h3>

      <select name="activite" required>
        <option value="">ActivitÃ©</option>
        <option value="collectif">Temps collectif</option>
        <option value="accompagnement">Accompagnement / soin</option>
        <option value="relation">Relation usager / famille</option>
        <option value="organisation">Organisation / coordination</option>
        <option value="solo">Travail en autonomie</option>
        <option value="imprevu">Gestion dâ€™imprÃ©vu</option>
      </select>

      <textarea name="situation" rows="3" placeholder="Situation vÃ©cue" required></textarea>

      <input name="forces" list="forcesList" placeholder="Force mobilisÃ©e" required>
      <datalist id="forcesList">
        <option>Empathie</option><option>Ã‰coute active</option><option>Patience</option>
        <option>CrÃ©ativitÃ©</option><option>RÃ©silience</option><option>AdaptabilitÃ©</option>
        <option>CoopÃ©ration</option><option>Leadership calme</option>
        <option>ResponsabilitÃ©</option><option>Humour</option>
        <option>Espoir</option><option>Justesse</option>
      </datalist>

      <input name="pourQui" placeholder="Pour qui ?" required>

      <button type="submit">ğŸŒ± Planter</button>
    </form>
  </div>

  <h2>ğŸŒ³ Jardin des forces</h2>
  <svg id="garden" viewBox="0 0 1400 700"></svg>

</div>

<script>
/* ---------- DATA ---------- */
const PASSWORD = atob("bm91dGthcnJv");
let gardenData = JSON.parse(localStorage.getItem("garden") || "[]");

/* ---------- LOGIN ---------- */
function checkPassword() {
    if (document.getElementById("pwd").value === PASSWORD) {
        document.getElementById("login").style.display = "none";
        document.getElementById("main").style.display = "block";
        loadQuote();
        generateGarden();
    }
}

/* ---------- QUOTES ---------- */
function loadQuote() {
    const quotes = [
        "Ce quâ€™on arrose pousse.",
        "Chaque attention est une graine.",
        "Le collectif fleurit quand on le regarde.",
        "Une force reconnue grandit."
    ];
    document.getElementById("quote").textContent =
        quotes[Math.floor(Math.random() * quotes.length)];
}

/* ---------- FORM ---------- */
function openForm() {
    document.getElementById("formOverlay").style.display = "flex";
}

document.getElementById("contribForm").addEventListener("submit", e => {
    e.preventDefault();
    const fd = new FormData(e.target);
    gardenData.unshift({
        id: Date.now(),
        activite: fd.get("activite"),
        situation: fd.get("situation"),
        forces: fd.get("forces"),
        pourQui: fd.get("pourQui"),
        date: new Date().toLocaleDateString("fr-FR")
    });
    localStorage.setItem("garden", JSON.stringify(gardenData));
    e.target.reset();
    document.getElementById("formOverlay").style.display = "none";
    generateGarden();
});

/* ---------- GARDEN ---------- */
function generateGarden() {
    const svg = document.getElementById("garden");
    svg.innerHTML = "";

    if (!gardenData.length) {
        svg.innerHTML =
          `<text x="700" y="350" text-anchor="middle" fill="#4CAF50" font-size="32">
            Plante ta premiÃ¨re force ğŸŒ±
          </text>`;
        return;
    }

    gardenData.slice(0,24).forEach((p,i)=>{
        const col = i % 8;
        const row = Math.floor(i / 8);
        const x = 150 + col * 150;
        const y = 550 - row * 120;

        let emoji = "ğŸŒ±";
        if (p.activite==="collectif") emoji="ğŸŒ³";
        if (p.activite==="accompagnement") emoji="ğŸŒ¸";
        if (p.activite==="relation") emoji="ğŸŒ¿";
        if (p.activite==="organisation") emoji="ğŸŒ¾";
        if (p.activite==="solo") emoji="ğŸƒ";
        if (p.activite==="imprevu") emoji="ğŸŒµ";

        svg.insertAdjacentHTML("beforeend",`
        <g class="plant" transform="translate(${x},${y})"
           onclick="showPlant(${p.id})">
            <line x1="0" y1="0" x2="0" y2="-40"
                  stroke="#4CAF50" stroke-width="4"/>
            <text x="0" y="-50" font-size="36" text-anchor="middle">${emoji}</text>
        </g>
        `);
    });
}

function showPlant(id) {
    const p = gardenData.find(x=>x.id===id);
    if(p){
        alert(
          `ğŸŒ¿ ActivitÃ© : ${p.activite}\n`+
          `ğŸ“ ${p.situation}\n`+
          `ğŸ’ª ${p.forces}\n`+
          `ğŸ‘¥ ${p.pourQui}\n`+
          `ğŸ“… ${p.date}`
        );
    }
}
</script>

</body>
</html>
